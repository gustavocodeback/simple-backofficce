{"version":3,"sources":["../../src/pages/pesquisar-veiculo/pesquisar-veiculo.module.ts","../../src/pages/pesquisar-veiculo/pesquisar-veiculo.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PesquisarVeiculoPage } from './pesquisar-veiculo';\n\n@NgModule({\n  declarations: [\n    PesquisarVeiculoPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(PesquisarVeiculoPage),\n  ],\n})\nexport class PesquisarVeiculoPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pesquisar-veiculo/pesquisar-veiculo.module.ts","import { LoadingController } from 'ionic-angular/components/loading/loading-controller';\nimport { AuthProvider } from './../../providers/auth/auth';\nimport { GatewayProvider } from './../../providers/gateway/gateway';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController, ModalController, App, Events } from 'ionic-angular';\n\n@IonicPage()\n@Component({\n  selector: 'page-pesquisar-veiculo',\n  templateUrl: 'pesquisar-veiculo.html',\n})\nexport class PesquisarVeiculoPage {\n\n  public onRequest: boolean = false;\n  public currentPage = 1;\n  public totalPages = 1;\n  public query: string = '';\n  public gateways = [];\n  public following = [];\n  public unfollowing = [];\n\n  constructor(public navCtrl: NavController, \n              public navParams: NavParams,\n              public viewCtrl: ViewController,\n              public gatewayProvider: GatewayProvider,\n              public authProvider: AuthProvider,\n              public modalCtrl: ModalController,\n              public app: App,\n              public loadingCtrl: LoadingController,\n              public events: Events,\n              public auth: AuthProvider) {\n  }\n\n  /**\n   * Faz a pesquisa\n   * \n   * @param reset \n   */\n  searchGateway( reset = false ) {\n\n    if ( this.onRequest ) return;\n    this.onRequest = true;\n\n    // Verifica se deve resetar\n    if ( reset ) {\n      this.currentPage = 1;\n      this.totalPages  = 1;\n    }\n\n    // Seta a página a ser carregada\n    const p = reset ? 1 : parseInt( this.currentPage.toString() ) + 1;\n  \n    // Faz a requisição\n    this.gatewayProvider.searchAll( this.query, p )\n    .then( gateways => {\n\n      // Quando nao vir nada na query\n      if( this.query.length == 0 ) {\n        this.following   = [];\n        this.unfollowing = [];\n        this.gateways = [];\n        return;\n      }\n      \n      // Quando nao vier fontes\n      if( gateways.length == 0 ) {\n        this.totalPages = 0;\n        return;\n      }\n\n      // Seta os parametros\n      this.currentPage = gateways.page;\n      this.totalPages  = gateways.total_pages;\n\n      // Verifica se deve resetar ou não resetar\n      if ( reset ) {\n        this.gateways = gateways.data;\n      } else {\n        for( let gateway of gateways.data ) {\n          this.gateways.push( gateway );\n        }\n      }\n    \n      // Seta od feeds\n      this.following   = this.gateways.filter( value => value.status != 'U' );\n      this.unfollowing = this.gateways.filter( value => value.status == 'U' );\n    })\n    .catch( e => console.log( e ) )\n    .then( () => {\n      this.onRequest = false;\n    });\n  }\n\n  /**\n   * Abre o perfil da notícia\n   * \n   */\n  public perfilNoticia( id ) {\n    this.navCtrl.push( \"PerfilNoticiaPage\", { id } );\n  }\n\n  /**\n   * Segue o veiculo\n   * \n   * @param gateway \n   */\n  follow( gateway ) {\n    \n    // verifica está logado\n    const user = this.authProvider.user();\n    \n    // verifica se veio user\n    if( user ) {\n      const modal = this.modalCtrl.create( 'FollowModalPage', { gateway } );\n      modal.onDidDismiss( data => {\n        \n        // Verifica se salvou\n        if ( data ) this.searchGateway( true );\n      });\n      modal.present();\n    } else {\n      this.navCtrl.push( \"LoginPage\", { redirectPage: true } );\n    }\n  }\n\n  /**\n   * Deixa de seguir o veiculo\n   * \n   * @param gateway_id \n   */\n  unfollow( gateway_id ) {\n    \n    // Mostra o loading\n    const loading = this.loadingCtrl.create( { content: 'Retirando inscrição...' } );\n    loading.present();\n\n    // Faz a chamada\n    this.gatewayProvider.unfollow( gateway_id )\n    .then( success => {\n\n      // Faz as atualizações\n      this.searchGateway( true );\n      this.events.publish( 'atualizar' );      \n    })\n    .catch( err => console.log(false) )\n    .then( () => loading.dismiss() );\n  }\n\n  /**\n   * Muda o status\n   * \n   */\n  async toggleMuted( gateway ) {\n    \n    // verifica está logado\n    const user = this.auth.user();\n\n    // verifica se veio user\n    if( user ) {\n\n      // Exibe o loading\n      const loading = this.loadingCtrl.create({\n        content: gateway['muted'] ? 'Habilidatando função' : 'Desabilitando função'\n      });\n      loading.present();\n\n      // Faz a chamada\n      const method = gateway['muted'] ? 'unmute' : 'mute';\n      try {\n        await this.gatewayProvider[method]( gateway['id'] );\n      } catch ( error ) {\n        console.log( error );\n      }\n  \n      // Esconde o loading\n      loading.dismiss();\n      this.searchGateway( true );\n    } else {\n      this.navCtrl.push( \"LoginPage\", { redirectPage: true } );\n    }\n  }\n\n  /**\n   * Fecha o modal de pesquisa\n   * \n   */\n  close() {\n    this.viewCtrl.dismiss();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/pesquisar-veiculo/pesquisar-veiculo.ts"],"sourceRoot":""}