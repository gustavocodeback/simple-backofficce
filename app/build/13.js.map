{"version":3,"sources":["../../src/pages/follow-modal/follow-modal.module.ts","../../src/pages/follow-modal/follow-modal.ts"],"names":[],"mappings":"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","file":"13.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { FollowModalPage } from './follow-modal';\n\n@NgModule({\n  declarations: [\n    FollowModalPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(FollowModalPage),\n  ],\n})\nexport class FollowModalPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/follow-modal/follow-modal.module.ts","import { GatewayProvider } from './../../providers/gateway/gateway';\nimport { AuthProvider } from './../../providers/auth/auth';\nimport { PersonalCategoryProvider } from './../../providers/personal-category/personal-category';\nimport { ValidateProvider } from './../../providers/validate/validate';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController, LoadingController, Events } from 'ionic-angular';\nimport { FormGroup } from '@angular/forms';\n\n@IonicPage()\n@Component({\n  selector: 'page-follow-modal',\n  templateUrl: 'follow-modal.html',\n})\nexport class FollowModalPage {\n\n  // formulario\n  public categoryForm: FormGroup;\n  \n  // validador\n  public validate: ValidateProvider;\n\n  // categorias exemplo\n  public categorias = [];\n\n  // veiculo\n  public gateway = {};\n\n  // Se deseja criar uma nova categoria\n  public criar = false;\n\n  /**\n   * Método construtor\n   * \n   * @param navCtrl \n   * @param navParams \n   * @param viewCtrl \n   * @param loadingCtrl \n   * @param personalCategory \n   * @param auth \n   * @param gate \n   */\n  constructor(public navCtrl: NavController, \n              public navParams: NavParams,\n              public viewCtrl: ViewController,\n              public loadingCtrl: LoadingController,\n              public personalCategory: PersonalCategoryProvider,\n              public auth: AuthProvider,\n              public gate: GatewayProvider,\n              public events: Events) {\n\n    // pega o id do veiculo\n    this.gateway = this.navParams.get( 'gateway' );\n  }\n\n  /**\n   * Quando entrar na pagina\n   * \n   */\n  async ionViewDidEnter() {\n\n    // Mostra loading\n    const loading = this.loadingCtrl.create( { content: 'Carregando categorias pessoais...' });\n    loading.present();\n    \n    try {\n\n      // Pega as categorias pessoais\n      this.categorias = await this.personalCategory.list();    \n    \n    } catch ( error ) {\n      console.log( error );\n    }\n\n    // Esconde o loading\n    loading.dismiss();\n  }\n\n  /**\n   * saveFollow\n   * \n   * salva o follow do usuario\n   */\n  public saveFollow( personalCategoryId = false ) {\n\n    // salva o follow\n    this.gate.follow( this.gateway['id'], personalCategoryId )\n    .then( success => {\n      \n      // Fecha o modal\n      this.viewCtrl.dismiss( {'saved': true} );\n\n      // Dispara o evento\n      this.events.publish( 'atualizar' );\n      \n    })\n    .catch( err => { \n      console.log( err );\n      this.viewCtrl.dismiss( {'saved': false} );\n     });\n  }\n\n  /**\n   * saveCategory\n   */\n  public saveCategory() {\n    \n    // Verifica se o usuário está logado\n    if ( !this.auth.user( ) ) {\n      this.navCtrl.push( 'LoginPage' );\n      return;\n    }\n\n    // recebe os dados do formulario\n    const dados = JSON.parse( JSON.stringify( this.categoryForm.value ) );\n    dados.user_id = this.auth.user().id;\n\n    // tenta salvar a categoria\n    this.personalCategory.saveCategory( dados )\n    .then( personalCategory => {\n      \n      // Esconde o formulário\n      this.categoryForm.reset();\n      this.criar = false;\n\n      this.categorias.push( personalCategory );\n      this.saveFollow( personalCategory['id'] );\n      return;\n    })\n    .catch( err => { \n      console.log( err ); \n      this.viewCtrl.dismiss( {'saved': false } );\n    });\n  }\n\n  /**\n   * __initForm\n   * \n   * Inicia o formulario de nova categoria\n   */\n  private __initForm() {\n\n    // instancia um novo validador\n    this.validate = new ValidateProvider();\n\n    // seta as regras de validação\n    const rules = {\n      name : 'required|valid_email',\n    };\n\n    // seta o formulario\n    this.categoryForm = this.validate.set_form( rules );\n  }\n\n  /**\n   * criarCategoria\n   * \n   * cria uma nova categoria pessoal\n   */\n  public criarCategoria() {\n    if ( this.criar == false ) {\n      this.criar = true;\n      this.__initForm();\n    } else {\n      this.criar = false;\n    }\n  }\n\n  /**\n   * cancel\n   * \n   * cancela a ação\n   */\n  public cancel() {\n    this.viewCtrl.dismiss();\n  }\n}\n\n// End of file\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/follow-modal/follow-modal.ts"],"sourceRoot":""}