{"version":3,"sources":["../../src/pages/veiculos/veiculos.module.ts","../../src/pages/veiculos/veiculos.ts"],"names":[],"mappings":"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","file":"7.js","sourcesContent":["import { PipesModule } from './../../pipes/pipes.module';\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { VeiculosPage } from './veiculos';\n\n@NgModule({\n  declarations: [\n    VeiculosPage,\n  ],\n  imports: [\n    PipesModule,\n    IonicPageModule.forChild(VeiculosPage),\n  ],\n})\nexport class VeiculosPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/veiculos/veiculos.module.ts","import { LoadingController } from 'ionic-angular/components/loading/loading-controller';\nimport { AuthProvider } from './../../providers/auth/auth';\nimport { GatewayProvider } from './../../providers/gateway/gateway';\nimport { Category } from './../../providers/category/category.model';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ModalController, App, Events } from 'ionic-angular';\n\n\n@IonicPage()\n@Component({\n  selector: 'page-veiculos',\n  templateUrl: 'veiculos.html',\n})\nexport class VeiculosPage {\n\n  /**\n   * Categoria sendo pesquisada\n   * \n   */\n  public category: Category = null;\n\n  /**\n   * Gateways encontrados\n   * \n   */\n  public gateways = [];\n\n  /**\n   * Gateways seguidos\n   * \n   */\n  public following = [];\n\n  /**\n   * Gateways nao seguindos\n   * \n   */\n  public notFollowing = [];\n\n  /**\n   * Indica se algum request esta sendo feita\n   * \n   */\n  public onRequest: boolean = false;\n\n  /**\n   * Query de busca\n   * \n   */\n  public query: string = '';\n\n  /**\n   * Página atual\n   * \n   */\n  public currentPage = 1;\n\n  /**\n   * Total de páginas\n   * \n   */\n  public totalPages = 1;\n\n  /**\n   * Método constructor\n   * \n   * @param navCtrl \n   * @param modalCtrl \n   * @param navParams \n   */\n  constructor(  public navCtrl: NavController, \n                public modalCtrl: ModalController,\n                public gatewayProvider: GatewayProvider,\n                public navParams: NavParams,\n                public authProvider: AuthProvider,\n                public app: App,\n                public auth: AuthProvider,\n                public loadingCtrl: LoadingController,\n                public events: Events ) {\n\n    // Obtem a categoria de pesquisa\n    this.category = this.navParams.get( 'category' );\n    if ( !this.category ) this.back(); \n  }\n\n  /**\n   * Quando entrar na view\n   * \n   */\n  ionViewDidEnter(){\n    this.updateList( true );\n  }\n\n  /**\n   * Pega os itens\n   * \n   */\n  public updateList( reset = false ) {\n    if ( this.onRequest ) return;\n    this.onRequest = true;\n\n    // Verifica se deve resetar\n    if ( reset ) {\n      this.currentPage = 1;\n      this.totalPages  = 1;\n    }\n\n    // Seta a página a ser carregada\n    const p = reset ? 1 : parseInt( this.currentPage.toString() ) + 1;\n\n    // Faz a requisição\n    this.gatewayProvider.getGatewayByCategory( this.query, this.category.id, p )\n    .then( gateways => {\n\n      // Seta os parametros\n      this.currentPage = gateways.page;\n      this.totalPages  = gateways.total_pages;\n\n      // Verifica se deve resetar ou não\n      if ( reset ) {\n        this.gateways = gateways.data;\n      } else {\n        for( let gateway of gateways.data ) {\n          this.gateways.push( gateway );\n        }\n      }\n\n      // Seta od feeds\n      this.following    = this.gateways.filter( value => !value.muted );\n      this.notFollowing = this.gateways.filter( value => value.muted );\n\n    })\n    .catch( e => console.log( e ) )\n    .then( () => this.onRequest = false );\n  }\n\n  /**\n   * Abre o perfil da notícia\n   * \n   */\n  public perfilNoticia( id ) {\n    this.navCtrl.push( \"PerfilNoticiaPage\", { id } );\n  }\n\n  /**\n   * Fecha a pagina\n   * \n   */\n  public back() {\n    if( this.navCtrl.canGoBack() ) {\n      this.navCtrl.pop()\n    } else this.navCtrl.push( 'FeedPage' );\n  }\n\n  /**\n   * Segue o veiculo\n   * \n   * @param gateway \n   */\n  follow( gateway ) {\n\n    // verifica está logado\n    const user = this.authProvider.user();\n    \n    // verifica se veio user\n    if( user ) {\n      const modal = this.modalCtrl.create( 'FollowModalPage', { gateway } );\n      modal.onDidDismiss( data => {\n        \n        // Verifica se salvou\n        if ( data ) this.updateList( true );\n      });\n      modal.present();\n    } else {\n      this.navCtrl.push( \"LoginPage\", { redirectPage: true } );\n    }\n  }\n\n  /**\n   * Deixa de seguir o veiculo\n   * \n   * @param gateway_id \n   */\n  unfollow( gateway_id ) {\n    \n    // Mostra o loading\n    const loading = this.loadingCtrl.create( { content: 'Retirando inscrição...' } );\n    loading.present();\n\n    // Faz a chamada\n    this.gatewayProvider.unfollow( gateway_id )\n    .then( success => {\n\n      // Faz as atualizações\n      this.updateList( true );\n      this.events.publish( 'atualizar' );      \n    })\n    .catch( err => console.log(false) )\n    .then( () => loading.dismiss() );\n  }\n\n  /**\n   * Muda o status\n   * \n   */\n  async toggleMuted( gateway ) {\n\n    // verifica está logado\n    const user = this.auth.user();\n\n    // verifica se veio user\n    if( user ) {\n\n      // Exibe o loading\n      const loading = this.loadingCtrl.create({\n        content: gateway['muted'] ? 'Habilidatando função' : 'Desabilitando função'\n      });\n      loading.present();\n\n      // Faz a chamada\n      const method = gateway['muted'] ? 'unmute' : 'mute';\n      try {\n        await this.gatewayProvider[method]( gateway['id'] );\n      } catch ( error ) {\n        console.log( error );\n      }\n  \n      // Esconde o loading\n      loading.dismiss();\n      this.updateList( true );\n    } else {\n      this.navCtrl.push( \"LoginPage\", { redirectPage: true } );\n    }\n  }\n}\n\n// End of file\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/veiculos/veiculos.ts"],"sourceRoot":""}